# Базовые настройки
http_port 3128
visible_hostname proxy1.example.lab

# Логирование
access_log /var/log/squid/access.log
cache_log /var/log/squid/cache.log

# Настройки кэша
cache_mem 64 MB
maximum_object_size_in_memory 256 KB
cache_dir ufs /var/squid/cache 100 16 256
maximum_object_size 4 MB

# ACL и правила доступа
acl localnet src 192.168.1.0/24
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 443
acl CONNECT method CONNECT

http_access allow localnet
http_access allow localhost
http_access deny all

# Настройки родительского прокси (для каскада)
cache_peer 192.168.1.2 parent 3128 0 no-query default
never_direct allow all

# Оптимизация
forwarded_for off
request_header_access Via deny all
request_header_access X-Forwarded-For deny all
